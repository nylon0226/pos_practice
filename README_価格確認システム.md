# 価格確認システム  
（Excel VBA × cmd.exe × Python × SQLite）

## 概要
本リポジトリは、Excel VBA・Python・SQLite を組み合わせた価格確認システムの学習・模擬実装プロジェクトです。  
Excel を UI および制御の起点とし、Python を業務ロジック、SQLite をマスタデータとして分離することで、  
現場に存在しがちなレガシー構成をあえて再現しています。

本プロジェクトの目的は「綺麗なシステムを作ること」ではありません。  
壊れたときに **どこで・なぜ壊れたかを説明できる構造を理解すること** を主目的としています。

---

## 制作の動機
次職において、VBA と Python を併用した Excel ベースの受発注・価格計算系システムを扱う SES 業務への参画を予定しています。  
その事前学習として、本システムを制作しました。

単なる文法学習ではなく、以下を重視しています。

- Excel / VBA / OS / Python / DB の責務分離
- stdout・ExitCode・ファイル連携によるプロセス境界の理解
- 業務例外とシステム例外の切り分け

---

## システム構成

Excel（在庫シート）  
↓  
VBA（制御・外部実行）  
↓  
cmd.exe（OS実行）  
↓  
Python（業務処理）  
↓  
SQLite（マスタ参照）  
↓  
stdout  
↓  
result.txt  
↓  
VBA（結果解釈）  
↓  
Excel（結果反映）  

---

## ディレクトリ構成

```
pos_practice/
├─ excel/
│  └─ 価格確認システム.xlsm
│
├─ src/
│  ├─ hello.py
│  ├─ master.db
│  ├─ result.txt
│  └─ create_db.py
│
├─ data/
│  └─ master.csv
│
├─ venv/
│  └─ Scripts/python.exe
│
└─ docs/
   ├─ コード.pdf
   └─ 価格確認システム_発表用.pdf
```

---

## 処理仕様（概要）

### 入力
- 商品コード
- 数量  
（Excel シートより取得）

### 出力（stdout 契約）
- 正常時  
  OK,単価,合計金額

- 業務例外  
  ERROR,理由

### 想定外例外
- stdout には何も出力せず異常終了
- VBA 側で PY_FAIL として層別

---

## 設計思想

- stdout は業務契約
- ExitCode は処理到達点の指標
- ファイルを介することで処理状況を可視化

正しさよりも **説明可能性** を優先しています。

---

## まとめ

本プロジェクトは、  
VBA や Python を上手く書くことが目的ではありません。  
壊れたときに「どこで・なぜ壊れているか」を説明できる構造を理解することを目的としています。

---

※ 本リポジトリは学習・説明用途を前提としています。
